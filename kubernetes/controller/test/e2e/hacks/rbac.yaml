# This is the required configuration for our test deployments to work.
# It is not intended for production use and should not be used as a reference for production RBAC configuration.
# Out test suite relies on kro for many examples, and the manager needs permissions to manage the custom resources defined by kro,
# as well as some core Kubernetes resources for its ApplySet operations.
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: controller-manager-role-e2e
rules:
  # Your custom permissions that are needed to deploy and clean up your components.
  # You should use the least privileged permissions possible.
  # This is for our testing setup, you will need to apply your own permissions based on your components' needs.
  - apiGroups:
      - kro.run
    resources:
      - resourcegraphdefinitions
    verbs:
      - create
      - delete
      - list
      - patch
      - update
      - watch
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    app.kubernetes.io/name: ocm-k8s-toolkit
  name: controller-manager-rolebinding-e2e
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: controller-manager-role-e2e
subjects:
  - kind: ServiceAccount
    name: ocm-k8s-toolkit-controller-manager
    namespace: ocm-k8s-toolkit-system
