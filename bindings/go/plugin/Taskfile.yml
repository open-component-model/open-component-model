version: '3'

includes:
  reuse: ../../../reuse.Taskfile.yml


tasks:
  build:
    cmds:
      - go build -o tmp/testdata/test-plugin-component-version internal/testplugin-component-version/main.go
      - go build -o tmp/testdata/test-plugin-resource internal/testplugin-resource/main.go
      - go build -o tmp/testdata/test-plugin-input internal/testplugin-input/main.go
      - go build -o tmp/testdata/test-plugin-digester internal/testplugin-digester/main.go
      - go build -o tmp/testdata/test-plugin-blobtransformer internal/testplugin-blobtransformer/main.go
      - go build -o tmp/testdata/test-plugin-signinghandler internal/testplugin-signinghandler/main.go
      - go build -o tmp/testdata/test-plugin-component-lister internal/testplugin-component-lister/main.go
      - GOOS=wasip1 GOARCH=wasm go build -buildmode=c-shared -o tmp/testdata/test-plugin-wasm-input.wasm internal/testplugin-wasm-input/main.go
  test:
    cmds:
      - task: reuse:run-go-test
    deps:
      - build
